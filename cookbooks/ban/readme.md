# Ban

A custom chef recipe that allows you to ban IP addresses from accessing your servers, via iptables.

## Usage

Add the IPs that you wish to ban to the `recipes/default.rb` file, using the following syntax:

```ruby
ban('ban name') do
  ip "111.111.111.111"
  ip "222.222.222.222", :ports => [22, 80, 443]
  ip "222.0.0.0/8"
end
```

This will ban the IP address `111.111.111.111` from accessing any port on the instance. It then bans `222.222.222.222` on ports `22`, `80` and `443`. Finally, it will ban any IP address on the `222.0.0.0/8` subnet.

You can view the rules generated by the recipe by running `iptables --list INPUT` on an instance:

```
# iptables --list INPUT
Chain INPUT (policy ACCEPT)
target     prot opt source               destination
DROP       all  --  128-23-83-192.musc.edu  anywhere            /* chef */
DROP       tcp  --  243.123.123.123      anywhere            /* chef */ tcp dpt:ssh
DROP       tcp  --  243.123.123.123      anywhere            /* chef */ tcp dpt:http
DROP       tcp  --  243.123.123.123      anywhere            /* chef */ tcp dpt:https
```

## Warning

Be warned that if you ban a subnet mask on port 22, you may accidentally block yourself, EY Support or other users that need legitimate acccess to your instances.
